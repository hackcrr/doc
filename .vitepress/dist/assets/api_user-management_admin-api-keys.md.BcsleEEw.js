import{_ as n,c as a,o as l,aj as p}from"./chunks/framework.e3UxQEvm.js";const i=JSON.parse('{"title":"API å¯†é’¥ç®¡ç†","description":"","frontmatter":{},"headers":[],"relativePath":"api/user-management/admin-api-keys.md","filePath":"api/user-management/admin-api-keys.md","lastUpdated":0}'),o={name:"api/user-management/admin-api-keys.md"};function e(t,s,r,c,F,D){return l(),a("div",null,[...s[0]||(s[0]=[p(`<h1 id="api-å¯†é’¥ç®¡ç†" tabindex="-1">API å¯†é’¥ç®¡ç† <a class="header-anchor" href="#api-å¯†é’¥ç®¡ç†" aria-label="Permalink to â€œAPI å¯†é’¥ç®¡ç†â€">â€‹</a></h1><h2 id="ç«¯ç‚¹ä¿¡æ¯" tabindex="-1">ç«¯ç‚¹ä¿¡æ¯ <a class="header-anchor" href="#ç«¯ç‚¹ä¿¡æ¯" aria-label="Permalink to â€œç«¯ç‚¹ä¿¡æ¯â€">â€‹</a></h2><div class="language-http line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">GET</span><span style="color:#BABED8;"> /admin/api-keys</span></span>
<span class="line"><span style="color:#F07178;">Authorization</span><span style="color:#F78C6C;">:</span><span style="color:#C3E88D;"> Bearer your_api_key</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>åˆ—å‡ºæ‰€æœ‰ API å¯†é’¥ä¿¡æ¯ã€‚</p><div class="language-http line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">POST</span><span style="color:#BABED8;"> /admin/api-keys/{api_key}/revoke</span></span>
<span class="line"><span style="color:#F07178;">Authorization</span><span style="color:#F78C6C;">:</span><span style="color:#C3E88D;"> Bearer your_api_key</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>æ’¤é”€æŒ‡å®šçš„ API å¯†é’¥ã€‚</p><div class="language-http line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">GET</span><span style="color:#BABED8;"> /admin/api-keys/{user_id}</span></span>
<span class="line"><span style="color:#F07178;">Authorization</span><span style="color:#F78C6C;">:</span><span style="color:#C3E88D;"> Bearer your_api_key</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>è·å–æŒ‡å®šç”¨æˆ·çš„æ‰€æœ‰ API å¯†é’¥ã€‚</p><h2 id="æƒé™è¦æ±‚" tabindex="-1">æƒé™è¦æ±‚ <a class="header-anchor" href="#æƒé™è¦æ±‚" aria-label="Permalink to â€œæƒé™è¦æ±‚â€">â€‹</a></h2><ul><li><code>user_management</code> æƒé™</li></ul><h2 id="è¯·æ±‚" tabindex="-1">è¯·æ±‚ <a class="header-anchor" href="#è¯·æ±‚" aria-label="Permalink to â€œè¯·æ±‚â€">â€‹</a></h2><h3 id="åˆ—å‡ºæ‰€æœ‰-api-å¯†é’¥" tabindex="-1">åˆ—å‡ºæ‰€æœ‰ API å¯†é’¥ <a class="header-anchor" href="#åˆ—å‡ºæ‰€æœ‰-api-å¯†é’¥" aria-label="Permalink to â€œåˆ—å‡ºæ‰€æœ‰ API å¯†é’¥â€">â€‹</a></h3><h4 id="è¯·æ±‚å¤´" tabindex="-1">è¯·æ±‚å¤´ <a class="header-anchor" href="#è¯·æ±‚å¤´" aria-label="Permalink to â€œè¯·æ±‚å¤´â€">â€‹</a></h4><table tabindex="0"><thead><tr><th>å¤´éƒ¨</th><th>å€¼</th><th>å¿…å¡«</th></tr></thead><tbody><tr><td><code>Authorization</code></td><td><code>Bearer your_api_key</code></td><td>æ˜¯</td></tr></tbody></table><h3 id="æ’¤é”€-api-å¯†é’¥" tabindex="-1">æ’¤é”€ API å¯†é’¥ <a class="header-anchor" href="#æ’¤é”€-api-å¯†é’¥" aria-label="Permalink to â€œæ’¤é”€ API å¯†é’¥â€">â€‹</a></h3><h4 id="è¯·æ±‚å¤´-1" tabindex="-1">è¯·æ±‚å¤´ <a class="header-anchor" href="#è¯·æ±‚å¤´-1" aria-label="Permalink to â€œè¯·æ±‚å¤´â€">â€‹</a></h4><table tabindex="0"><thead><tr><th>å¤´éƒ¨</th><th>å€¼</th><th>å¿…å¡«</th></tr></thead><tbody><tr><td><code>Authorization</code></td><td><code>Bearer your_api_key</code></td><td>æ˜¯</td></tr></tbody></table><h4 id="è·¯å¾„å‚æ•°" tabindex="-1">è·¯å¾„å‚æ•° <a class="header-anchor" href="#è·¯å¾„å‚æ•°" aria-label="Permalink to â€œè·¯å¾„å‚æ•°â€">â€‹</a></h4><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>å¿…å¡«</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>api_key</code></td><td>string</td><td>æ˜¯</td><td>è¦æ’¤é”€çš„ API å¯†é’¥</td></tr></tbody></table><h3 id="è·å–ç”¨æˆ·-api-å¯†é’¥" tabindex="-1">è·å–ç”¨æˆ· API å¯†é’¥ <a class="header-anchor" href="#è·å–ç”¨æˆ·-api-å¯†é’¥" aria-label="Permalink to â€œè·å–ç”¨æˆ· API å¯†é’¥â€">â€‹</a></h3><h4 id="è¯·æ±‚å¤´-2" tabindex="-1">è¯·æ±‚å¤´ <a class="header-anchor" href="#è¯·æ±‚å¤´-2" aria-label="Permalink to â€œè¯·æ±‚å¤´â€">â€‹</a></h4><table tabindex="0"><thead><tr><th>å¤´éƒ¨</th><th>å€¼</th><th>å¿…å¡«</th></tr></thead><tbody><tr><td><code>Authorization</code></td><td><code>Bearer your_api_key</code></td><td>æ˜¯</td></tr></tbody></table><h4 id="è·¯å¾„å‚æ•°-1" tabindex="-1">è·¯å¾„å‚æ•° <a class="header-anchor" href="#è·¯å¾„å‚æ•°-1" aria-label="Permalink to â€œè·¯å¾„å‚æ•°â€">â€‹</a></h4><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>å¿…å¡«</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>user_id</code></td><td>string</td><td>æ˜¯</td><td>ç”¨æˆ· ID</td></tr></tbody></table><h2 id="å“åº”" tabindex="-1">å“åº” <a class="header-anchor" href="#å“åº”" aria-label="Permalink to â€œå“åº”â€">â€‹</a></h2><h3 id="åˆ—å‡º-api-å¯†é’¥æˆåŠŸå“åº”" tabindex="-1">åˆ—å‡º API å¯†é’¥æˆåŠŸå“åº” <a class="header-anchor" href="#åˆ—å‡º-api-å¯†é’¥æˆåŠŸå“åº”" aria-label="Permalink to â€œåˆ—å‡º API å¯†é’¥æˆåŠŸå“åº”â€">â€‹</a></h3><p><strong>çŠ¶æ€ç :</strong> <code>200 OK</code></p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">success</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> true,</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">api_keys</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">    {</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">api_key_display</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">wB8xR2qZ...yZ8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">api_key_full</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">wB8xR2qZ9kL3mN7pV1sT5uY4aB6cD8eF0gH2jK4lM6nP8rQ0tS2vU4wX6yZ8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">user_id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">user_1705734000_abc123</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">username</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">admin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">description</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">é»˜è®¤ç®¡ç†å‘˜å¯†é’¥</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">is_active</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> true,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">created_at</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">2024-01-20T10:00:00</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">last_used</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">2024-01-20T15:30:00</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">expires_at</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> null</span></span>
<span class="line"><span style="color:#89DDFF;">    },</span></span>
<span class="line"><span style="color:#89DDFF;">    {</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">api_key_display</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">aB3cD5eF...hJ9</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">api_key_full</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">aB3cD5eF7gH9jK1lM3nP5rQ7tS9vU1wX3yZ5aB7cD9eF1gH3jK5lM7nP9</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">user_id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">user_1705734100_def456</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">username</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">operator1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">description</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">æ“ä½œå‘˜å¯†é’¥</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">is_active</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> true,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">created_at</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">2024-01-20T11:00:00</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">last_used</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">2024-01-20T14:20:00</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">expires_at</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> null</span></span>
<span class="line"><span style="color:#89DDFF;">    }</span></span>
<span class="line"><span style="color:#89DDFF;">  ],</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">total</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;"> 2</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">security_note</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">å®Œæ•´APIå¯†é’¥ä»…ç”¨äºåˆå§‹é…ç½®ï¼Œè¯·å¦¥å–„ä¿ç®¡</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h3 id="æ’¤é”€-api-å¯†é’¥æˆåŠŸå“åº”" tabindex="-1">æ’¤é”€ API å¯†é’¥æˆåŠŸå“åº” <a class="header-anchor" href="#æ’¤é”€-api-å¯†é’¥æˆåŠŸå“åº”" aria-label="Permalink to â€œæ’¤é”€ API å¯†é’¥æˆåŠŸå“åº”â€">â€‹</a></h3><p><strong>çŠ¶æ€ç :</strong> <code>200 OK</code></p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">success</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> true,</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">message</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">APIå¯†é’¥å·²æ’¤é”€</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="è·å–ç”¨æˆ·-api-å¯†é’¥æˆåŠŸå“åº”" tabindex="-1">è·å–ç”¨æˆ· API å¯†é’¥æˆåŠŸå“åº” <a class="header-anchor" href="#è·å–ç”¨æˆ·-api-å¯†é’¥æˆåŠŸå“åº”" aria-label="Permalink to â€œè·å–ç”¨æˆ· API å¯†é’¥æˆåŠŸå“åº”â€">â€‹</a></h3><p><strong>çŠ¶æ€ç :</strong> <code>200 OK</code></p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">success</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> true,</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">api_keys</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">    {</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">api_key_display</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">wB8xR2qZ...yZ8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">api_key_full</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">wB8xR2qZ9kL3mN7pV1sT5uY4aB6cD8eF0gH2jK4lM6nP8rQ0tS2vU4wX6yZ8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">description</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">é»˜è®¤ç®¡ç†å‘˜å¯†é’¥</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">is_active</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> true,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">created_at</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">2024-01-20T10:00:00</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">last_used</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">2024-01-20T15:30:00</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    }</span></span>
<span class="line"><span style="color:#89DDFF;">  ],</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">user_id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">user_1705734000_abc123</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">username</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">admin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">total</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;"> 1</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="é”™è¯¯å“åº”" tabindex="-1">é”™è¯¯å“åº” <a class="header-anchor" href="#é”™è¯¯å“åº”" aria-label="Permalink to â€œé”™è¯¯å“åº”â€">â€‹</a></h3><p><strong>API å¯†é’¥ä¸å­˜åœ¨:</strong></p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">error</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">APIå¯†é’¥ä¸å­˜åœ¨</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>ç”¨æˆ·ä¸å­˜åœ¨:</strong></p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">error</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">ç”¨æˆ·ä¸å­˜åœ¨</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="å“åº”å­—æ®µè¯´æ˜" tabindex="-1">å“åº”å­—æ®µè¯´æ˜ <a class="header-anchor" href="#å“åº”å­—æ®µè¯´æ˜" aria-label="Permalink to â€œå“åº”å­—æ®µè¯´æ˜â€">â€‹</a></h2><h3 id="api-å¯†é’¥ä¿¡æ¯" tabindex="-1">API å¯†é’¥ä¿¡æ¯ <a class="header-anchor" href="#api-å¯†é’¥ä¿¡æ¯" aria-label="Permalink to â€œAPI å¯†é’¥ä¿¡æ¯â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>api_key_display</code></td><td>string</td><td>éƒ¨åˆ†æ˜¾ç¤ºçš„ API å¯†é’¥ï¼ˆå®‰å…¨è€ƒè™‘ï¼‰</td></tr><tr><td><code>api_key_full</code></td><td>string</td><td>å®Œæ•´çš„ API å¯†é’¥</td></tr><tr><td><code>user_id</code></td><td>string</td><td>æ‰€å±ç”¨æˆ· ID</td></tr><tr><td><code>username</code></td><td>string</td><td>æ‰€å±ç”¨æˆ·å</td></tr><tr><td><code>description</code></td><td>string</td><td>å¯†é’¥æè¿°</td></tr><tr><td><code>is_active</code></td><td>boolean</td><td>æ˜¯å¦æ¿€æ´»</td></tr><tr><td><code>created_at</code></td><td>string</td><td>åˆ›å»ºæ—¶é—´</td></tr><tr><td><code>last_used</code></td><td>string</td><td>æœ€åä½¿ç”¨æ—¶é—´</td></tr><tr><td><code>expires_at</code></td><td>string</td><td>è¿‡æœŸæ—¶é—´</td></tr></tbody></table><h2 id="ä½¿ç”¨ç¤ºä¾‹" tabindex="-1">ä½¿ç”¨ç¤ºä¾‹ <a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹" aria-label="Permalink to â€œä½¿ç”¨ç¤ºä¾‹â€">â€‹</a></h2><h3 id="curl-ç¤ºä¾‹" tabindex="-1">cURL ç¤ºä¾‹ <a class="header-anchor" href="#curl-ç¤ºä¾‹" aria-label="Permalink to â€œcURL ç¤ºä¾‹â€">â€‹</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#676E95;font-style:italic;"># åˆ—å‡ºæ‰€æœ‰ API å¯†é’¥</span></span>
<span class="line"><span style="color:#FFCB6B;">curl</span><span style="color:#C3E88D;"> -X</span><span style="color:#C3E88D;"> GET</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">https://dbapi.muzilix.cn/admin/api-keys</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> \\</span></span>
<span class="line"><span style="color:#C3E88D;">  -H</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">Authorization: Bearer your_api_key</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># æ’¤é”€æŒ‡å®šçš„ API å¯†é’¥</span></span>
<span class="line"><span style="color:#FFCB6B;">curl</span><span style="color:#C3E88D;"> -X</span><span style="color:#C3E88D;"> POST</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">https://dbapi.muzilix.cn/admin/api-keys/wB8xR2qZ9kL3mN7pV1sT5uY4aB6cD8eF0gH2jK4lM6nP8rQ0tS2vU4wX6yZ8/revoke</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> \\</span></span>
<span class="line"><span style="color:#C3E88D;">  -H</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">Authorization: Bearer your_api_key</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># è·å–æŒ‡å®šç”¨æˆ·çš„æ‰€æœ‰ API å¯†é’¥</span></span>
<span class="line"><span style="color:#FFCB6B;">curl</span><span style="color:#C3E88D;"> -X</span><span style="color:#C3E88D;"> GET</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">https://dbapi.muzilix.cn/admin/api-keys/user_1705734000_abc123</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> \\</span></span>
<span class="line"><span style="color:#C3E88D;">  -H</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">Authorization: Bearer your_api_key</span><span style="color:#89DDFF;">&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="python-ç¤ºä¾‹" tabindex="-1">Python ç¤ºä¾‹ <a class="header-anchor" href="#python-ç¤ºä¾‹" aria-label="Permalink to â€œPython ç¤ºä¾‹â€">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> requests</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> json</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> typing </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> List</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> Dict</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> Optional</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> datetime </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> datetime</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#FFCB6B;"> APIKeyManager</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#C792EA;">    def</span><span style="color:#82AAFF;"> __init__</span><span style="color:#89DDFF;">(</span><span style="color:#F07178;font-style:italic;">self</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> api_key</span><span style="color:#89DDFF;">:</span><span style="color:#FFCB6B;"> str</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> base_url</span><span style="color:#89DDFF;">:</span><span style="color:#FFCB6B;"> str</span><span style="color:#89DDFF;"> =</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">https://dbapi.muzilix.cn</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#BABED8;">        self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">api_key</span><span style="color:#89DDFF;"> =</span><span style="color:#BABED8;"> api_key</span></span>
<span class="line"><span style="color:#BABED8;">        self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">base_url</span><span style="color:#89DDFF;"> =</span><span style="color:#BABED8;"> base_url</span></span>
<span class="line"><span style="color:#BABED8;">        self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">headers</span><span style="color:#89DDFF;"> =</span><span style="color:#89DDFF;"> {</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Authorization</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;"> f</span><span style="color:#C3E88D;">&quot;Bearer </span><span style="color:#F78C6C;">{</span><span style="color:#BABED8;">api_key</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#C792EA;">    def</span><span style="color:#82AAFF;"> list_all_api_keys</span><span style="color:#89DDFF;">(</span><span style="color:#F07178;font-style:italic;">self</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> -&gt;</span><span style="color:#BABED8;"> Optional</span><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">Dict</span><span style="color:#89DDFF;">]:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        &quot;&quot;&quot;</span><span style="color:#676E95;font-style:italic;">åˆ—å‡ºæ‰€æœ‰ API å¯†é’¥</span><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#BABED8;">        url </span><span style="color:#89DDFF;">=</span><span style="color:#C792EA;"> f</span><span style="color:#C3E88D;">&quot;</span><span style="color:#F78C6C;">{</span><span style="color:#BABED8;">self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">base_url</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">/admin/api-keys&quot;</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        try</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">            response </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> requests</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">url</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> headers</span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;">self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">headers</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">            result </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> response</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">json</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">            </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            if</span><span style="color:#BABED8;"> response</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">status_code</span><span style="color:#89DDFF;"> ==</span><span style="color:#F78C6C;"> 200</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">                return</span><span style="color:#BABED8;"> result</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            else</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#82AAFF;">                print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;âŒ è·å–APIå¯†é’¥åˆ—è¡¨å¤±è´¥: </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">result</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">error</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">                return</span><span style="color:#89DDFF;"> None</span></span>
<span class="line"><span style="color:#BABED8;">                </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        except</span><span style="color:#FFCB6B;"> Exception</span><span style="color:#89DDFF;font-style:italic;"> as</span><span style="color:#BABED8;"> e</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#82AAFF;">            print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;âŒ è¯·æ±‚å¤±è´¥: </span><span style="color:#F78C6C;">{</span><span style="color:#FFCB6B;">str</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">e</span><span style="color:#89DDFF;">)</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            return</span><span style="color:#89DDFF;"> None</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#C792EA;">    def</span><span style="color:#82AAFF;"> revoke_api_key</span><span style="color:#89DDFF;">(</span><span style="color:#F07178;font-style:italic;">self</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> api_key_to_revoke</span><span style="color:#89DDFF;">:</span><span style="color:#FFCB6B;"> str</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> -&gt;</span><span style="color:#FFCB6B;"> bool</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        &quot;&quot;&quot;</span><span style="color:#676E95;font-style:italic;">æ’¤é”€ API å¯†é’¥</span><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#BABED8;">        url </span><span style="color:#89DDFF;">=</span><span style="color:#C792EA;"> f</span><span style="color:#C3E88D;">&quot;</span><span style="color:#F78C6C;">{</span><span style="color:#BABED8;">self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">base_url</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">/admin/api-keys/</span><span style="color:#F78C6C;">{</span><span style="color:#BABED8;">api_key_to_revoke</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">/revoke&quot;</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        try</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">            response </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> requests</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">post</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">url</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> headers</span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;">self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">headers</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">            result </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> response</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">json</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">            </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            if</span><span style="color:#BABED8;"> response</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">status_code</span><span style="color:#89DDFF;"> ==</span><span style="color:#F78C6C;"> 200</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#82AAFF;">                print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;âœ… APIå¯†é’¥å·²æ’¤é”€&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">                return</span><span style="color:#89DDFF;"> True</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            else</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#82AAFF;">                print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;âŒ æ’¤é”€APIå¯†é’¥å¤±è´¥: </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">result</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">error</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">                return</span><span style="color:#89DDFF;"> False</span></span>
<span class="line"><span style="color:#BABED8;">                </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        except</span><span style="color:#FFCB6B;"> Exception</span><span style="color:#89DDFF;font-style:italic;"> as</span><span style="color:#BABED8;"> e</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#82AAFF;">            print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;âŒ è¯·æ±‚å¤±è´¥: </span><span style="color:#F78C6C;">{</span><span style="color:#FFCB6B;">str</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">e</span><span style="color:#89DDFF;">)</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            return</span><span style="color:#89DDFF;"> False</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#C792EA;">    def</span><span style="color:#82AAFF;"> get_user_api_keys</span><span style="color:#89DDFF;">(</span><span style="color:#F07178;font-style:italic;">self</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> user_id</span><span style="color:#89DDFF;">:</span><span style="color:#FFCB6B;"> str</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> -&gt;</span><span style="color:#BABED8;"> Optional</span><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">Dict</span><span style="color:#89DDFF;">]:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        &quot;&quot;&quot;</span><span style="color:#676E95;font-style:italic;">è·å–æŒ‡å®šç”¨æˆ·çš„æ‰€æœ‰ API å¯†é’¥</span><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#BABED8;">        url </span><span style="color:#89DDFF;">=</span><span style="color:#C792EA;"> f</span><span style="color:#C3E88D;">&quot;</span><span style="color:#F78C6C;">{</span><span style="color:#BABED8;">self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">base_url</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">/admin/api-keys/</span><span style="color:#F78C6C;">{</span><span style="color:#BABED8;">user_id</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        try</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">            response </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> requests</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">url</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> headers</span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;">self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">headers</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">            result </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> response</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">json</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">            </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            if</span><span style="color:#BABED8;"> response</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">status_code</span><span style="color:#89DDFF;"> ==</span><span style="color:#F78C6C;"> 200</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">                return</span><span style="color:#BABED8;"> result</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            else</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#82AAFF;">                print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;âŒ è·å–ç”¨æˆ·APIå¯†é’¥å¤±è´¥: </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">result</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">error</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">                return</span><span style="color:#89DDFF;"> None</span></span>
<span class="line"><span style="color:#BABED8;">                </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        except</span><span style="color:#FFCB6B;"> Exception</span><span style="color:#89DDFF;font-style:italic;"> as</span><span style="color:#BABED8;"> e</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#82AAFF;">            print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;âŒ è¯·æ±‚å¤±è´¥: </span><span style="color:#F78C6C;">{</span><span style="color:#FFCB6B;">str</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">e</span><span style="color:#89DDFF;">)</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            return</span><span style="color:#89DDFF;"> None</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#C792EA;">    def</span><span style="color:#82AAFF;"> display_api_keys_table</span><span style="color:#89DDFF;">(</span><span style="color:#F07178;font-style:italic;">self</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        &quot;&quot;&quot;</span><span style="color:#676E95;font-style:italic;">ä»¥è¡¨æ ¼å½¢å¼æ˜¾ç¤º API å¯†é’¥åˆ—è¡¨</span><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#BABED8;">        result </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> self</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">list_all_api_keys</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        if</span><span style="color:#89DDFF;"> not</span><span style="color:#BABED8;"> result </span><span style="color:#89DDFF;">or</span><span style="color:#89DDFF;"> not</span><span style="color:#BABED8;"> result</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">success</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            return</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#BABED8;">        api_keys </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> result</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">api_keys</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> [])</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ğŸ”‘ API å¯†é’¥ç®¡ç†</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> *</span><span style="color:#F78C6C;"> 120</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;</span><span style="color:#F78C6C;">{</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ç”¨æˆ·</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C792EA;">:&lt;12</span><span style="color:#F78C6C;">}</span><span style="color:#F78C6C;"> {</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">å¯†é’¥(éƒ¨åˆ†)</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C792EA;">:&lt;20</span><span style="color:#F78C6C;">}</span><span style="color:#F78C6C;"> {</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">æè¿°</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C792EA;">:&lt;20</span><span style="color:#F78C6C;">}</span><span style="color:#F78C6C;"> {</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">çŠ¶æ€</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C792EA;">:&lt;8</span><span style="color:#F78C6C;">}</span><span style="color:#F78C6C;"> {</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">åˆ›å»ºæ—¶é—´</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C792EA;">:&lt;19</span><span style="color:#F78C6C;">}</span><span style="color:#F78C6C;"> {</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">æœ€åä½¿ç”¨</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C792EA;">:&lt;19</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">-</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> *</span><span style="color:#F78C6C;"> 120</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        for</span><span style="color:#BABED8;"> key </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#BABED8;"> api_keys</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">            username </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">username</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#BABED8;">            api_key_display </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">api_key_display</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#BABED8;">            description </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">description</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span><span style="color:#89DDFF;"> or</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">æ— æè¿°</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">            status </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">âœ… æ¿€æ´»</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;font-style:italic;"> if</span><span style="color:#BABED8;"> key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">is_active</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span><span style="color:#89DDFF;font-style:italic;"> else</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">âŒ ç¦ç”¨</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">            created_at </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">created_at</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">][:</span><span style="color:#F78C6C;">19</span><span style="color:#89DDFF;">].</span><span style="color:#82AAFF;">replace</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">T</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;font-style:italic;"> if</span><span style="color:#BABED8;"> key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">created_at</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span><span style="color:#89DDFF;font-style:italic;"> else</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">N/A</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">            last_used </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">last_used</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">][:</span><span style="color:#F78C6C;">19</span><span style="color:#89DDFF;">].</span><span style="color:#82AAFF;">replace</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">T</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;font-style:italic;"> if</span><span style="color:#BABED8;"> key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">last_used</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span><span style="color:#89DDFF;font-style:italic;"> else</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">ä»æœªä½¿ç”¨</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">            </span></span>
<span class="line"><span style="color:#82AAFF;">            print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;</span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">username</span><span style="color:#C792EA;">:&lt;12</span><span style="color:#F78C6C;">}</span><span style="color:#F78C6C;"> {</span><span style="color:#82AAFF;">api_key_display</span><span style="color:#C792EA;">:&lt;20</span><span style="color:#F78C6C;">}</span><span style="color:#F78C6C;"> {</span><span style="color:#82AAFF;">description</span><span style="color:#C792EA;">:&lt;20</span><span style="color:#F78C6C;">}</span><span style="color:#F78C6C;"> {</span><span style="color:#82AAFF;">status</span><span style="color:#C792EA;">:&lt;8</span><span style="color:#F78C6C;">}</span><span style="color:#F78C6C;"> {</span><span style="color:#82AAFF;">created_at</span><span style="color:#C792EA;">:&lt;19</span><span style="color:#F78C6C;">}</span><span style="color:#F78C6C;"> {</span><span style="color:#82AAFF;">last_used</span><span style="color:#C792EA;">:&lt;19</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;</span><span style="color:#BABED8;">\\n</span><span style="color:#C3E88D;">æ€»è®¡: </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">len</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">api_keys</span><span style="color:#89DDFF;">)</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;"> ä¸ªAPIå¯†é’¥&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">        # æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯</span></span>
<span class="line"><span style="color:#BABED8;">        active_keys </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> sum</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;font-style:italic;"> for</span><span style="color:#82AAFF;"> key </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#82AAFF;"> api_keys </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#82AAFF;"> key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">is_active</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">])</span></span>
<span class="line"><span style="color:#BABED8;">        inactive_keys </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> len</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">api_keys</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> -</span><span style="color:#BABED8;"> active_keys</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;æ¿€æ´»: </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">active_keys</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">, ç¦ç”¨: </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">inactive_keys</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#C792EA;">    def</span><span style="color:#82AAFF;"> find_inactive_keys</span><span style="color:#89DDFF;">(</span><span style="color:#F07178;font-style:italic;">self</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> days_threshold</span><span style="color:#89DDFF;">:</span><span style="color:#FFCB6B;"> int</span><span style="color:#89DDFF;"> =</span><span style="color:#F78C6C;"> 30</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> -&gt;</span><span style="color:#BABED8;"> List</span><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">Dict</span><span style="color:#89DDFF;">]:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        &quot;&quot;&quot;</span><span style="color:#676E95;font-style:italic;">æŸ¥æ‰¾é•¿æœŸæœªä½¿ç”¨çš„ API å¯†é’¥</span><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#BABED8;">        result </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> self</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">list_all_api_keys</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        if</span><span style="color:#89DDFF;"> not</span><span style="color:#BABED8;"> result </span><span style="color:#89DDFF;">or</span><span style="color:#89DDFF;"> not</span><span style="color:#BABED8;"> result</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">success</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            return</span><span style="color:#89DDFF;"> []</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#BABED8;">        api_keys </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> result</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">api_keys</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> [])</span></span>
<span class="line"><span style="color:#BABED8;">        inactive_keys </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;"> []</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        for</span><span style="color:#BABED8;"> key </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#BABED8;"> api_keys</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            if</span><span style="color:#89DDFF;"> not</span><span style="color:#BABED8;"> key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">is_active</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">                continue</span></span>
<span class="line"><span style="color:#BABED8;">                </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            if</span><span style="color:#BABED8;"> key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">last_used</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]:</span></span>
<span class="line"><span style="color:#BABED8;">                last_used </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> datetime</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">fromisoformat</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">last_used</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">].</span><span style="color:#82AAFF;">replace</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Z</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#C3E88D;">+00:00</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">))</span></span>
<span class="line"><span style="color:#BABED8;">                days_since_use </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;"> (</span><span style="color:#BABED8;">datetime</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">now</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">astimezone</span><span style="color:#89DDFF;">()</span><span style="color:#89DDFF;"> -</span><span style="color:#BABED8;"> last_used</span><span style="color:#89DDFF;">).</span><span style="color:#F07178;">days</span></span>
<span class="line"><span style="color:#BABED8;">                </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">                if</span><span style="color:#BABED8;"> days_since_use </span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;"> days_threshold</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">                    inactive_keys</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#89DDFF;">({</span></span>
<span class="line"><span style="color:#89DDFF;">                        &quot;</span><span style="color:#C3E88D;">api_key</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">api_key_full</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#89DDFF;">                        &quot;</span><span style="color:#C3E88D;">username</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">username</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#89DDFF;">                        &quot;</span><span style="color:#C3E88D;">last_used</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">last_used</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#89DDFF;">                        &quot;</span><span style="color:#C3E88D;">days_inactive</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> days_since_use</span></span>
<span class="line"><span style="color:#89DDFF;">                    })</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        return</span><span style="color:#BABED8;"> inactive_keys</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#C792EA;">    def</span><span style="color:#82AAFF;"> bulk_revoke_inactive_keys</span><span style="color:#89DDFF;">(</span><span style="color:#F07178;font-style:italic;">self</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> days_threshold</span><span style="color:#89DDFF;">:</span><span style="color:#FFCB6B;"> int</span><span style="color:#89DDFF;"> =</span><span style="color:#F78C6C;"> 90</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> -&gt;</span><span style="color:#FFCB6B;"> int</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        &quot;&quot;&quot;</span><span style="color:#676E95;font-style:italic;">æ‰¹é‡æ’¤é”€é•¿æœŸæœªä½¿ç”¨çš„ API å¯†é’¥</span><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#BABED8;">        inactive_keys </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> self</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">find_inactive_keys</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">days_threshold</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">        revoked_count </span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;"> 0</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        if</span><span style="color:#89DDFF;"> not</span><span style="color:#BABED8;"> inactive_keys</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#82AAFF;">            print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;âœ… æ²¡æœ‰æ‰¾åˆ°è¶…è¿‡ </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">days_threshold</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;"> å¤©æœªä½¿ç”¨çš„APIå¯†é’¥&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            return</span><span style="color:#F78C6C;"> 0</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;ğŸ” æ‰¾åˆ° </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">len</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">inactive_keys</span><span style="color:#89DDFF;">)</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;"> ä¸ªè¶…è¿‡ </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">days_threshold</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;"> å¤©æœªä½¿ç”¨çš„APIå¯†é’¥:&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        for</span><span style="color:#BABED8;"> key </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#BABED8;"> inactive_keys</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#82AAFF;">            print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;   - </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">username</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">: æœ€åä½¿ç”¨ </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">days_inactive</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;"> å¤©å‰&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">            </span></span>
<span class="line"><span style="color:#BABED8;">            confirm </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> input</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;ç¡®è®¤æ’¤é”€ </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">username</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;"> çš„APIå¯†é’¥? (y/N): &quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">strip</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">lower</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            if</span><span style="color:#BABED8;"> confirm </span><span style="color:#89DDFF;">==</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#C3E88D;">y</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">                if</span><span style="color:#BABED8;"> self</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">revoke_api_key</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">api_key</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]):</span></span>
<span class="line"><span style="color:#BABED8;">                    revoked_count </span><span style="color:#89DDFF;">+=</span><span style="color:#F78C6C;"> 1</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;âœ… å·²æ’¤é”€ </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">revoked_count</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;"> ä¸ªé•¿æœŸæœªä½¿ç”¨çš„APIå¯†é’¥&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        return</span><span style="color:#BABED8;"> revoked_count</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#82AAFF;"> interactive_api_key_management</span><span style="color:#89DDFF;">():</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    &quot;&quot;&quot;</span><span style="color:#676E95;font-style:italic;">äº¤äº’å¼ API å¯†é’¥ç®¡ç†</span><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    api_key </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> input</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">è¯·è¾“å…¥ç®¡ç†å‘˜APIå¯†é’¥: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">strip</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">    manager </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> APIKeyManager</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">api_key</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    while</span><span style="color:#89DDFF;"> True:</span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">\\n</span><span style="color:#C3E88D;">ğŸ”‘ API å¯†é’¥ç®¡ç†ç³»ç»Ÿ</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1. æŸ¥çœ‹æ‰€æœ‰ API å¯†é’¥</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2. æ’¤é”€ API å¯†é’¥</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">3. æŸ¥çœ‹ç”¨æˆ· API å¯†é’¥</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">4. æŸ¥æ‰¾é•¿æœŸæœªä½¿ç”¨çš„å¯†é’¥</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">5. æ‰¹é‡æ’¤é”€é•¿æœŸæœªä½¿ç”¨çš„å¯†é’¥</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">6. é€€å‡º</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#BABED8;">        choice </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> input</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">è¯·é€‰æ‹©æ“ä½œ (1-6): </span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">strip</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        if</span><span style="color:#BABED8;"> choice </span><span style="color:#89DDFF;">==</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">            manager</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">display_api_keys_table</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        elif</span><span style="color:#BABED8;"> choice </span><span style="color:#89DDFF;">==</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">2</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">            api_key_to_revoke </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> input</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">è¦æ’¤é”€çš„å®Œæ•´ API å¯†é’¥: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">strip</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">            confirm </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> input</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;ç¡®è®¤æ’¤é”€è¯¥ API å¯†é’¥? (y/N): &quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">strip</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">lower</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">            </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            if</span><span style="color:#BABED8;"> confirm </span><span style="color:#89DDFF;">==</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">y</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">                manager</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">revoke_api_key</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">api_key_to_revoke</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            else</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#82AAFF;">                print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">æ“ä½œå·²å–æ¶ˆ</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        elif</span><span style="color:#BABED8;"> choice </span><span style="color:#89DDFF;">==</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">3</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">            user_id </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> input</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ç”¨æˆ· ID: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">strip</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">            result </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> manager</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get_user_api_keys</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">user_id</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">            </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            if</span><span style="color:#BABED8;"> result </span><span style="color:#89DDFF;">and</span><span style="color:#BABED8;"> result</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">success</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#BABED8;">                keys </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> result</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">api_keys</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> [])</span></span>
<span class="line"><span style="color:#BABED8;">                username </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> result</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">username</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">æœªçŸ¥ç”¨æˆ·</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">                </span></span>
<span class="line"><span style="color:#82AAFF;">                print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;</span><span style="color:#BABED8;">\\n</span><span style="color:#C3E88D;">ğŸ‘¤ ç”¨æˆ· </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">username</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;"> çš„ API å¯†é’¥:&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">                for</span><span style="color:#BABED8;"> key </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#BABED8;"> keys</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">                    status </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">æ¿€æ´»</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;font-style:italic;"> if</span><span style="color:#BABED8;"> key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">is_active</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span><span style="color:#89DDFF;font-style:italic;"> else</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">ç¦ç”¨</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#82AAFF;">                    print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;   - </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">api_key_display</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;"> (</span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">status</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">) - </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">description</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            else</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#82AAFF;">                print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">âŒ è·å–ç”¨æˆ·APIå¯†é’¥å¤±è´¥</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        elif</span><span style="color:#BABED8;"> choice </span><span style="color:#89DDFF;">==</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">4</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">            days </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> input</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">æœªä½¿ç”¨å¤©æ•°é˜ˆå€¼ [30]: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">strip</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">            days_threshold </span><span style="color:#89DDFF;">=</span><span style="color:#FFCB6B;"> int</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">days</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;font-style:italic;"> if</span><span style="color:#BABED8;"> days</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">isdigit</span><span style="color:#89DDFF;">()</span><span style="color:#89DDFF;font-style:italic;"> else</span><span style="color:#F78C6C;"> 30</span></span>
<span class="line"><span style="color:#BABED8;">            </span></span>
<span class="line"><span style="color:#BABED8;">            inactive_keys </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> manager</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">find_inactive_keys</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">days_threshold</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">            </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            if</span><span style="color:#BABED8;"> inactive_keys</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#82AAFF;">                print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;</span><span style="color:#BABED8;">\\n</span><span style="color:#C3E88D;">ğŸ” è¶…è¿‡ </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">days_threshold</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;"> å¤©æœªä½¿ç”¨çš„ API å¯†é’¥:&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">                for</span><span style="color:#BABED8;"> key </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#BABED8;"> inactive_keys</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#82AAFF;">                    print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;   - </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">username</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">: </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">days_inactive</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;"> å¤©æœªä½¿ç”¨&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            else</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#82AAFF;">                print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;âœ… æ²¡æœ‰æ‰¾åˆ°è¶…è¿‡ </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">days_threshold</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;"> å¤©æœªä½¿ç”¨çš„APIå¯†é’¥&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        elif</span><span style="color:#BABED8;"> choice </span><span style="color:#89DDFF;">==</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">5</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">            days </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> input</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">æœªä½¿ç”¨å¤©æ•°é˜ˆå€¼ [90]: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">strip</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">            days_threshold </span><span style="color:#89DDFF;">=</span><span style="color:#FFCB6B;"> int</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">days</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;font-style:italic;"> if</span><span style="color:#BABED8;"> days</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">isdigit</span><span style="color:#89DDFF;">()</span><span style="color:#89DDFF;font-style:italic;"> else</span><span style="color:#F78C6C;"> 90</span></span>
<span class="line"><span style="color:#BABED8;">            </span></span>
<span class="line"><span style="color:#BABED8;">            manager</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">bulk_revoke_inactive_keys</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">days_threshold</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        elif</span><span style="color:#BABED8;"> choice </span><span style="color:#89DDFF;">==</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">6</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#82AAFF;">            print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">é€€å‡º API å¯†é’¥ç®¡ç†ç³»ç»Ÿ</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            break</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        else</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#82AAFF;">            print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">âŒ æ— æ•ˆé€‰æ‹©</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># ä½¿ç”¨ç¤ºä¾‹</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#BABED8;"> __name__ </span><span style="color:#89DDFF;">==</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">__main__</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    # æ–¹å¼1: ç›´æ¥ä½¿ç”¨</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    # manager = APIKeyManager(&quot;your_admin_api_key&quot;)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    # manager.display_api_keys_table()</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    # æ–¹å¼2: æŸ¥æ‰¾é•¿æœŸæœªä½¿ç”¨çš„å¯†é’¥</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    # manager = APIKeyManager(&quot;your_admin_api_key&quot;)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    # inactive_keys = manager.find_inactive_keys(30)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    # for key in inactive_keys:</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    #     print(f&quot;{key[&#39;username&#39;]}: {key[&#39;days_inactive&#39;]}å¤©æœªä½¿ç”¨&quot;)</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    # æ–¹å¼3: äº¤äº’å¼ç®¡ç†</span></span>
<span class="line"><span style="color:#82AAFF;">    interactive_api_key_management</span><span style="color:#89DDFF;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br></div></div><h2 id="ç®¡ç†åŠŸèƒ½è¯´æ˜" tabindex="-1">ç®¡ç†åŠŸèƒ½è¯´æ˜ <a class="header-anchor" href="#ç®¡ç†åŠŸèƒ½è¯´æ˜" aria-label="Permalink to â€œç®¡ç†åŠŸèƒ½è¯´æ˜â€">â€‹</a></h2><h3 id="_1-å¯†é’¥å®‰å…¨" tabindex="-1">1. å¯†é’¥å®‰å…¨ <a class="header-anchor" href="#_1-å¯†é’¥å®‰å…¨" aria-label="Permalink to â€œ1. å¯†é’¥å®‰å…¨â€">â€‹</a></h3><ul><li>å®Œæ•´å¯†é’¥ä»…åœ¨åˆå§‹é…ç½®æ—¶æ˜¾ç¤º</li><li>æ—¥å¸¸ç®¡ç†ä½¿ç”¨éƒ¨åˆ†æ˜¾ç¤ºçš„å¯†é’¥</li><li>æ”¯æŒå¯†é’¥æ’¤é”€è€Œéåˆ é™¤</li><li>ä¿ç•™å®¡è®¡è®°å½•</li></ul><h3 id="_2-ä½¿ç”¨ç›‘æ§" tabindex="-1">2. ä½¿ç”¨ç›‘æ§ <a class="header-anchor" href="#_2-ä½¿ç”¨ç›‘æ§" aria-label="Permalink to â€œ2. ä½¿ç”¨ç›‘æ§â€">â€‹</a></h3><ul><li>è®°å½•æœ€åä½¿ç”¨æ—¶é—´</li><li>è·Ÿè¸ªå¯†é’¥æ´»è·ƒçŠ¶æ€</li><li>æ”¯æŒåŸºäºæ—¶é—´çš„æ¸…ç†ç­–ç•¥</li></ul><h3 id="_3-æ‰¹é‡æ“ä½œ" tabindex="-1">3. æ‰¹é‡æ“ä½œ <a class="header-anchor" href="#_3-æ‰¹é‡æ“ä½œ" aria-label="Permalink to â€œ3. æ‰¹é‡æ“ä½œâ€">â€‹</a></h3><ul><li>æŸ¥æ‰¾é•¿æœŸæœªä½¿ç”¨çš„å¯†é’¥</li><li>æ‰¹é‡æ’¤é”€è¿‡æœŸå¯†é’¥</li><li>ç”¨æˆ·çº§åˆ«çš„å¯†é’¥ç®¡ç†</li></ul><h2 id="å®‰å…¨æœ€ä½³å®è·µ" tabindex="-1">å®‰å…¨æœ€ä½³å®è·µ <a class="header-anchor" href="#å®‰å…¨æœ€ä½³å®è·µ" aria-label="Permalink to â€œå®‰å…¨æœ€ä½³å®è·µâ€">â€‹</a></h2><h3 id="_1-å®šæœŸå®¡æŸ¥" tabindex="-1">1. å®šæœŸå®¡æŸ¥ <a class="header-anchor" href="#_1-å®šæœŸå®¡æŸ¥" aria-label="Permalink to â€œ1. å®šæœŸå®¡æŸ¥â€">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#C792EA;">def</span><span style="color:#82AAFF;"> monthly_key_audit</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">manager</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    &quot;&quot;&quot;</span><span style="color:#676E95;font-style:italic;">æœˆåº¦å¯†é’¥å®¡è®¡</span><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#82AAFF;">    print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ğŸ” æ‰§è¡Œæœˆåº¦ API å¯†é’¥å®¡è®¡...</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    # æŸ¥æ‰¾90å¤©æœªä½¿ç”¨çš„å¯†é’¥</span></span>
<span class="line"><span style="color:#BABED8;">    inactive_keys </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> manager</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">find_inactive_keys</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">90</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    if</span><span style="color:#BABED8;"> inactive_keys</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;å‘ç° </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">len</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">inactive_keys</span><span style="color:#89DDFF;">)</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;"> ä¸ªé•¿æœŸæœªä½¿ç”¨çš„å¯†é’¥&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">        # å¯ä»¥å‘é€é€šçŸ¥æˆ–è‡ªåŠ¨å¤„ç†</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    else</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">âœ… æ‰€æœ‰å¯†é’¥éƒ½åœ¨æ­£å¸¸ä½¿ç”¨</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_2-å¯†é’¥è½®æ¢" tabindex="-1">2. å¯†é’¥è½®æ¢ <a class="header-anchor" href="#_2-å¯†é’¥è½®æ¢" aria-label="Permalink to â€œ2. å¯†é’¥è½®æ¢â€">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#C792EA;">def</span><span style="color:#82AAFF;"> enforce_key_rotation</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">manager</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> max_age_days</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">365</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    &quot;&quot;&quot;</span><span style="color:#676E95;font-style:italic;">å¼ºåˆ¶æ‰§è¡Œå¯†é’¥è½®æ¢</span><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    result </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> manager</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">list_all_api_keys</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    if</span><span style="color:#89DDFF;"> not</span><span style="color:#BABED8;"> result </span><span style="color:#89DDFF;">or</span><span style="color:#89DDFF;"> not</span><span style="color:#BABED8;"> result</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">success</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        return</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#BABED8;">    api_keys </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> result</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">api_keys</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> [])</span></span>
<span class="line"><span style="color:#BABED8;">    old_keys </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;"> []</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    for</span><span style="color:#BABED8;"> key </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#BABED8;"> api_keys</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        if</span><span style="color:#BABED8;"> key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">is_active</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span><span style="color:#89DDFF;"> and</span><span style="color:#BABED8;"> key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">created_at</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]:</span></span>
<span class="line"><span style="color:#BABED8;">            created_at </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> datetime</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">fromisoformat</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">created_at</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">].</span><span style="color:#82AAFF;">replace</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Z</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#C3E88D;">+00:00</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">))</span></span>
<span class="line"><span style="color:#BABED8;">            age_days </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;"> (</span><span style="color:#BABED8;">datetime</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">now</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">astimezone</span><span style="color:#89DDFF;">()</span><span style="color:#89DDFF;"> -</span><span style="color:#BABED8;"> created_at</span><span style="color:#89DDFF;">).</span><span style="color:#F07178;">days</span></span>
<span class="line"><span style="color:#BABED8;">            </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            if</span><span style="color:#BABED8;"> age_days </span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;"> max_age_days</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">                old_keys</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#89DDFF;">({</span></span>
<span class="line"><span style="color:#89DDFF;">                    &quot;</span><span style="color:#C3E88D;">api_key</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">api_key_full</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#89DDFF;">                    &quot;</span><span style="color:#C3E88D;">username</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> key</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">username</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#89DDFF;">                    &quot;</span><span style="color:#C3E88D;">age_days</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> age_days</span></span>
<span class="line"><span style="color:#89DDFF;">                })</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    return</span><span style="color:#BABED8;"> old_keys</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="ç›¸å…³é“¾æ¥" tabindex="-1">ç›¸å…³é“¾æ¥ <a class="header-anchor" href="#ç›¸å…³é“¾æ¥" aria-label="Permalink to â€œç›¸å…³é“¾æ¥â€">â€‹</a></h2><ul><li><a href="./admin-users">ç”¨æˆ·ç®¡ç†</a> - ç”¨æˆ·è´¦æˆ·ç®¡ç†</li><li><a href="./auth-login">ç”¨æˆ·è®¤è¯</a> - ç”¨æˆ·ç™»å½•è®¤è¯</li><li><a href="/reference/permission-matrix">æƒé™è¯´æ˜</a> - è¯¦ç»†æƒé™è¯´æ˜</li></ul>`,61)])])}const u=n(o,[["render",e]]);export{i as __pageData,u as default};
