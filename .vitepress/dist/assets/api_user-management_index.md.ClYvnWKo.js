import{_ as e,c as i,o as l,aj as r}from"./chunks/framework.e3UxQEvm.js";const u=JSON.parse('{"title":"用户管理","description":"","frontmatter":{},"headers":[],"relativePath":"api/user-management/index.md","filePath":"api/user-management/index.md","lastUpdated":1764594265000}'),d={name:"api/user-management/index.md"};function h(n,a,t,s,o,c){return l(),i("div",null,[...a[0]||(a[0]=[r('<h1 id="用户管理" tabindex="-1">用户管理 <a class="header-anchor" href="#用户管理" aria-label="Permalink to “用户管理”">​</a></h1><h2 id="概述" tabindex="-1">概述 <a class="header-anchor" href="#概述" aria-label="Permalink to “概述”">​</a></h2><p>用户管理 API 提供完整的用户认证、权限管理和访问控制功能，支持多角色权限体系、API 密钥管理和数据库级别的权限控制。</p><h2 id="接口列表" tabindex="-1">接口列表 <a class="header-anchor" href="#接口列表" aria-label="Permalink to “接口列表”">​</a></h2><h3 id="用户认证" tabindex="-1">用户认证 <a class="header-anchor" href="#用户认证" aria-label="Permalink to “用户认证”">​</a></h3><ul><li><a href="./auth-register"><code>POST /auth/register</code></a> - 用户自助注册</li><li><a href="./auth-login"><code>POST /auth/login</code></a> - 用户登录</li><li><a href="./auth-logout"><code>POST /auth/logout</code></a> - 用户登出</li><li><a href="./auth-profile"><code>GET /auth/profile</code></a> - 获取当前用户信息</li><li><a href="./change-password"><code>POST /auth/change-password</code></a> - 修改密码</li></ul><h3 id="用户管理-管理员" tabindex="-1">用户管理（管理员） <a class="header-anchor" href="#用户管理-管理员" aria-label="Permalink to “用户管理（管理员）”">​</a></h3><ul><li><a href="./admin-users"><code>POST /admin/users</code></a> - 创建用户</li><li><a href="./admin-users"><code>GET /admin/users</code></a> - 列出所有用户</li><li><a href="./admin-users"><code>PUT /admin/users/{user_id}</code></a> - 更新用户信息</li><li><a href="./admin-users"><code>DELETE /admin/users/{user_id}</code></a> - 删除用户</li><li><a href="./change-password"><code>POST /admin/users/{user_id}/reset-password</code></a> - 重置用户密码</li></ul><h3 id="api-密钥管理" tabindex="-1">API 密钥管理 <a class="header-anchor" href="#api-密钥管理" aria-label="Permalink to “API 密钥管理”">​</a></h3><ul><li><a href="./admin-api-keys"><code>GET /admin/api-keys</code></a> - 列出所有 API 密钥</li><li><a href="./admin-api-keys"><code>POST /admin/api-keys/{api_key}/revoke</code></a> - 撤销 API 密钥</li><li><a href="./admin-api-keys"><code>GET /admin/api-keys/{user_id}</code></a> - 获取用户 API 密钥</li></ul><h3 id="权限管理" tabindex="-1">权限管理 <a class="header-anchor" href="#权限管理" aria-label="Permalink to “权限管理”">​</a></h3><ul><li><a href="./database-permissions"><code>POST /admin/database-permissions</code></a> - 授予数据库权限</li><li><a href="./database-permissions"><code>GET /user/databases</code></a> - 获取用户数据库列表</li></ul><h3 id="系统管理" tabindex="-1">系统管理 <a class="header-anchor" href="#系统管理" aria-label="Permalink to “系统管理”">​</a></h3><ul><li><a href="./admin-users"><code>GET /admin/system-stats</code></a> - 获取系统统计信息（管理员视图）</li><li><a href="./admin-users"><code>GET /admin/users/search</code></a> - 搜索用户</li></ul><h2 id="通用要求" tabindex="-1">通用要求 <a class="header-anchor" href="#通用要求" aria-label="Permalink to “通用要求”">​</a></h2><h3 id="认证" tabindex="-1">认证 <a class="header-anchor" href="#认证" aria-label="Permalink to “认证”">​</a></h3><p>所有用户管理接口都需要认证：</p><div class="language-http line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#F07178;">Authorization</span><span style="color:#F78C6C;">:</span><span style="color:#C3E88D;"> Bearer your_api_key</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="权限要求" tabindex="-1">权限要求 <a class="header-anchor" href="#权限要求" aria-label="Permalink to “权限要求”">​</a></h3><ul><li>用户注册：无需认证（公开接口）</li><li>用户登录：无需认证（公开接口）</li><li>个人信息：<code>auth</code> 权限</li><li>用户管理：<code>user_management</code> 权限</li><li>API 密钥管理：<code>user_management</code> 权限</li><li>权限分配：<code>user_management</code> 权限</li></ul><h2 id="用户角色体系" tabindex="-1">用户角色体系 <a class="header-anchor" href="#用户角色体系" aria-label="Permalink to “用户角色体系”">​</a></h2><h3 id="角色定义" tabindex="-1">角色定义 <a class="header-anchor" href="#角色定义" aria-label="Permalink to “角色定义”">​</a></h3><table tabindex="0"><thead><tr><th>角色</th><th>权限级别</th><th>描述</th></tr></thead><tbody><tr><td><code>readonly</code></td><td>1</td><td>只读权限，仅能查询数据</td></tr><tr><td><code>operator</code></td><td>2</td><td>操作权限，可查询和插入数据</td></tr><tr><td><code>user</code></td><td>2</td><td>普通用户，可管理自己的数据库</td></tr><tr><td><code>admin</code></td><td>3</td><td>管理员，可管理用户和所有数据库</td></tr><tr><td><code>superadmin</code></td><td>4</td><td>超级管理员，拥有所有权限</td></tr></tbody></table><h3 id="默认权限" tabindex="-1">默认权限 <a class="header-anchor" href="#默认权限" aria-label="Permalink to “默认权限”">​</a></h3><p>每个角色都有预设的权限集合，管理员可以额外授予特定权限。</p><h2 id="认证机制" tabindex="-1">认证机制 <a class="header-anchor" href="#认证机制" aria-label="Permalink to “认证机制”">​</a></h2><h3 id="api-密钥认证" tabindex="-1">API 密钥认证 <a class="header-anchor" href="#api-密钥认证" aria-label="Permalink to “API 密钥认证”">​</a></h3><ul><li>32位 URL 安全令牌</li><li>Bearer Token 格式支持</li><li>自动失效和更新机制</li><li>使用记录审计</li></ul><h3 id="密码安全" tabindex="-1">密码安全 <a class="header-anchor" href="#密码安全" aria-label="Permalink to “密码安全”">​</a></h3><ul><li>SHA-256 加盐哈希</li><li>密码强度验证</li><li>定期密码更新</li><li>密码重置功能</li></ul><h2 id="权限控制" tabindex="-1">权限控制 <a class="header-anchor" href="#权限控制" aria-label="Permalink to “权限控制”">​</a></h2><h3 id="接口权限" tabindex="-1">接口权限 <a class="header-anchor" href="#接口权限" aria-label="Permalink to “接口权限”">​</a></h3><p>基于端点的细粒度权限控制，每个 API 端点都有对应的权限要求。</p><h3 id="数据库权限" tabindex="-1">数据库权限 <a class="header-anchor" href="#数据库权限" aria-label="Permalink to “数据库权限”">​</a></h3><p>三级数据库访问权限：</p><ul><li><code>read</code> - 只读访问</li><li><code>write</code> - 读写访问</li><li><code>admin</code> - 完全控制</li></ul><h3 id="权限继承" tabindex="-1">权限继承 <a class="header-anchor" href="#权限继承" aria-label="Permalink to “权限继承”">​</a></h3><ul><li>角色默认权限</li><li>额外授予权限</li><li>权限去重和合并</li></ul><h2 id="用户管理功能" tabindex="-1">用户管理功能 <a class="header-anchor" href="#用户管理功能" aria-label="Permalink to “用户管理功能”">​</a></h2><h3 id="自助服务" tabindex="-1">自助服务 <a class="header-anchor" href="#自助服务" aria-label="Permalink to “自助服务”">​</a></h3><ul><li>用户注册和账户激活</li><li>个人信息管理</li><li>密码修改和重置</li><li>API 密钥生成</li></ul><h3 id="管理功能" tabindex="-1">管理功能 <a class="header-anchor" href="#管理功能" aria-label="Permalink to “管理功能”">​</a></h3><ul><li>用户创建和删除</li><li>角色分配和权限管理</li><li>账户状态控制</li><li>操作审计日志</li></ul><h2 id="api-密钥管理-1" tabindex="-1">API 密钥管理 <a class="header-anchor" href="#api-密钥管理-1" aria-label="Permalink to “API 密钥管理”">​</a></h2><h3 id="密钥特性" tabindex="-1">密钥特性 <a class="header-anchor" href="#密钥特性" aria-label="Permalink to “密钥特性”">​</a></h3><ul><li>自动生成安全密钥</li><li>密钥描述和标签</li><li>启用/禁用控制</li><li>最后使用时间记录</li></ul><h3 id="安全措施" tabindex="-1">安全措施 <a class="header-anchor" href="#安全措施" aria-label="Permalink to “安全措施”">​</a></h3><ul><li>密钥部分显示</li><li>自动撤销机制</li><li>使用频率监控</li><li>异常访问检测</li></ul><h2 id="审计日志" tabindex="-1">审计日志 <a class="header-anchor" href="#审计日志" aria-label="Permalink to “审计日志”">​</a></h2><h3 id="操作记录" tabindex="-1">操作记录 <a class="header-anchor" href="#操作记录" aria-label="Permalink to “操作记录”">​</a></h3><ul><li>用户登录和登出</li><li>权限变更记录</li><li>敏感操作追踪</li><li>API 密钥使用</li></ul><h3 id="安全监控" tabindex="-1">安全监控 <a class="header-anchor" href="#安全监控" aria-label="Permalink to “安全监控”">​</a></h3><ul><li>失败登录尝试</li><li>权限变更审计</li><li>异常行为检测</li><li>系统访问统计</li></ul><h2 id="数据库集成" tabindex="-1">数据库集成 <a class="header-anchor" href="#数据库集成" aria-label="Permalink to “数据库集成”">​</a></h2><h3 id="用户存储" tabindex="-1">用户存储 <a class="header-anchor" href="#用户存储" aria-label="Permalink to “用户存储”">​</a></h3><ul><li>专用认证数据库 (<code>api_auth</code>)</li><li>用户信息加密存储</li><li>外键约束和完整性</li><li>事务安全操作</li></ul><h3 id="权限存储" tabindex="-1">权限存储 <a class="header-anchor" href="#权限存储" aria-label="Permalink to “权限存储”">​</a></h3><ul><li>角色权限映射</li><li>用户特定权限</li><li>数据库访问权限</li><li>权限授予记录</li></ul><h2 id="安全特性" tabindex="-1">安全特性 <a class="header-anchor" href="#安全特性" aria-label="Permalink to “安全特性”">​</a></h2><h3 id="数据保护" tabindex="-1">数据保护 <a class="header-anchor" href="#数据保护" aria-label="Permalink to “数据保护”">​</a></h3><ul><li>密码加盐哈希</li><li>API 密钥安全存储</li><li>敏感信息脱敏</li><li>数据传输加密</li></ul><h3 id="访问控制" tabindex="-1">访问控制 <a class="header-anchor" href="#访问控制" aria-label="Permalink to “访问控制”">​</a></h3><ul><li>基于角色的权限</li><li>数据库级别权限</li><li>接口级别权限</li><li>IP 地址和用户代理记录</li></ul><h2 id="限制说明" tabindex="-1">限制说明 <a class="header-anchor" href="#限制说明" aria-label="Permalink to “限制说明”">​</a></h2><h3 id="操作限制" tabindex="-1">操作限制 <a class="header-anchor" href="#操作限制" aria-label="Permalink to “操作限制”">​</a></h3><ul><li>用户注册：频率限制</li><li>密码重置：安全验证</li><li>API 密钥创建：数量限制</li><li>权限变更：审计记录</li></ul><h3 id="安全限制" tabindex="-1">安全限制 <a class="header-anchor" href="#安全限制" aria-label="Permalink to “安全限制”">​</a></h3><ul><li>会话超时控制</li><li>并发连接限制</li><li>失败尝试锁定</li><li>密钥轮换策略</li></ul><h2 id="默认配置" tabindex="-1">默认配置 <a class="header-anchor" href="#默认配置" aria-label="Permalink to “默认配置”">​</a></h2><h3 id="初始管理员" tabindex="-1">初始管理员 <a class="header-anchor" href="#初始管理员" aria-label="Permalink to “初始管理员”">​</a></h3><p>系统首次启动时自动创建默认管理员：</p><ul><li>用户名：<code>admin</code></li><li>密码：<code>admin123</code></li><li>角色：<code>superadmin</code></li></ul><h3 id="默认权限-1" tabindex="-1">默认权限 <a class="header-anchor" href="#默认权限-1" aria-label="Permalink to “默认权限”">​</a></h3><p>新用户注册时自动获得基本权限，包括自助服务和基础数据库操作权限。</p><h2 id="下一步" tabindex="-1">下一步 <a class="header-anchor" href="#下一步" aria-label="Permalink to “下一步”">​</a></h2><ul><li>👤 学习 <a href="./auth-login">用户认证</a></li><li>📝 了解 <a href="./auth-register">用户注册</a></li><li>🔐 掌握 <a href="./change-password">密码管理</a></li><li>👥 查看 <a href="./admin-users">用户管理</a></li><li>🔑 管理 <a href="./admin-api-keys">API 密钥</a></li><li>🎯 配置 <a href="./database-permissions">数据库权限</a></li></ul>',76)])])}const m=e(d,[["render",h]]);export{u as __pageData,m as default};
