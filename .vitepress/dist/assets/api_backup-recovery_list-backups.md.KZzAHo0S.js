import{_ as a,c as n,o as l,aj as p}from"./chunks/framework.e3UxQEvm.js";const i=JSON.parse('{"title":"è·å–å¤‡ä»½åˆ—è¡¨","description":"","frontmatter":{},"headers":[],"relativePath":"api/backup-recovery/list-backups.md","filePath":"api/backup-recovery/list-backups.md","lastUpdated":0}'),o={name:"api/backup-recovery/list-backups.md"};function e(t,s,r,c,F,D){return l(),n("div",null,[...s[0]||(s[0]=[p(`<h1 id="è·å–å¤‡ä»½åˆ—è¡¨" tabindex="-1">è·å–å¤‡ä»½åˆ—è¡¨ <a class="header-anchor" href="#è·å–å¤‡ä»½åˆ—è¡¨" aria-label="Permalink to â€œè·å–å¤‡ä»½åˆ—è¡¨â€">â€‹</a></h1><h2 id="ç«¯ç‚¹ä¿¡æ¯" tabindex="-1">ç«¯ç‚¹ä¿¡æ¯ <a class="header-anchor" href="#ç«¯ç‚¹ä¿¡æ¯" aria-label="Permalink to â€œç«¯ç‚¹ä¿¡æ¯â€">â€‹</a></h2><div class="language-http line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">GET</span><span style="color:#BABED8;"> /database/{db_name}/backups</span></span>
<span class="line"><span style="color:#F07178;">Authorization</span><span style="color:#F78C6C;">:</span><span style="color:#C3E88D;"> Bearer your_api_key</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>è·å–æŒ‡å®šæ•°æ®åº“çš„æ‰€æœ‰å¤‡ä»½æ–‡ä»¶åˆ—è¡¨å’Œä¿¡æ¯ã€‚</p><h2 id="æƒé™è¦æ±‚" tabindex="-1">æƒé™è¦æ±‚ <a class="header-anchor" href="#æƒé™è¦æ±‚" aria-label="Permalink to â€œæƒé™è¦æ±‚â€">â€‹</a></h2><ul><li><code>list_backups</code> æƒé™</li><li>å¯¹ç›®æ ‡æ•°æ®åº“çš„ <code>read</code> æƒé™</li></ul><h2 id="è¯·æ±‚" tabindex="-1">è¯·æ±‚ <a class="header-anchor" href="#è¯·æ±‚" aria-label="Permalink to â€œè¯·æ±‚â€">â€‹</a></h2><h3 id="è¯·æ±‚å¤´" tabindex="-1">è¯·æ±‚å¤´ <a class="header-anchor" href="#è¯·æ±‚å¤´" aria-label="Permalink to â€œè¯·æ±‚å¤´â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å¤´éƒ¨</th><th>å€¼</th><th>å¿…å¡«</th></tr></thead><tbody><tr><td><code>Authorization</code></td><td><code>Bearer your_api_key</code></td><td>æ˜¯</td></tr></tbody></table><h3 id="è·¯å¾„å‚æ•°" tabindex="-1">è·¯å¾„å‚æ•° <a class="header-anchor" href="#è·¯å¾„å‚æ•°" aria-label="Permalink to â€œè·¯å¾„å‚æ•°â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>å¿…å¡«</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>db_name</code></td><td>string</td><td>æ˜¯</td><td>æ•°æ®åº“åç§°</td></tr></tbody></table><h2 id="å“åº”" tabindex="-1">å“åº” <a class="header-anchor" href="#å“åº”" aria-label="Permalink to â€œå“åº”â€">â€‹</a></h2><h3 id="æˆåŠŸå“åº”" tabindex="-1">æˆåŠŸå“åº” <a class="header-anchor" href="#æˆåŠŸå“åº”" aria-label="Permalink to â€œæˆåŠŸå“åº”â€">â€‹</a></h3><p><strong>çŠ¶æ€ç :</strong> <code>200 OK</code></p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">database</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">my_database</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">backup_count</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;"> 3</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">backups</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">    {</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">filename</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">admin_my_database_manual_backup_2024_20240120_143000.sql.gz</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">filepath</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">/backups/admin_my_database_manual_backup_2024_20240120_143000.sql.gz</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">size</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;"> 1572864</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">size_human</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">1.50 MB</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">created_time</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">2024-01-20T14:30:00</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">modified_time</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">2024-01-20T14:35:00</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">compressed</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> true,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">backup_type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">manual</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">timestamp</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">20240120_143000</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    },</span></span>
<span class="line"><span style="color:#89DDFF;">    {</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">filename</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">admin_my_database_auto_backup_20240119_020000.sql</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">filepath</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">/backups/admin_my_database_auto_backup_20240119_020000.sql</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">size</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;"> 2097152</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">size_human</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">2.00 MB</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">created_time</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">2024-01-19T02:00:00</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">modified_time</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">2024-01-19T02:05:00</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">compressed</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> false,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">backup_type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">auto</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">timestamp</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">20240119_020000</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    }</span></span>
<span class="line"><span style="color:#89DDFF;">  ]</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h3 id="å“åº”å­—æ®µè¯´æ˜" tabindex="-1">å“åº”å­—æ®µè¯´æ˜ <a class="header-anchor" href="#å“åº”å­—æ®µè¯´æ˜" aria-label="Permalink to â€œå“åº”å­—æ®µè¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>database</code></td><td>string</td><td>æ•°æ®åº“åç§°</td></tr><tr><td><code>backup_count</code></td><td>integer</td><td>å¤‡ä»½æ–‡ä»¶æ•°é‡</td></tr><tr><td><code>backups</code></td><td>array</td><td>å¤‡ä»½æ–‡ä»¶åˆ—è¡¨</td></tr></tbody></table><h4 id="å¤‡ä»½æ–‡ä»¶ä¿¡æ¯" tabindex="-1">å¤‡ä»½æ–‡ä»¶ä¿¡æ¯ <a class="header-anchor" href="#å¤‡ä»½æ–‡ä»¶ä¿¡æ¯" aria-label="Permalink to â€œå¤‡ä»½æ–‡ä»¶ä¿¡æ¯â€">â€‹</a></h4><table tabindex="0"><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>filename</code></td><td>string</td><td>å¤‡ä»½æ–‡ä»¶å</td></tr><tr><td><code>filepath</code></td><td>string</td><td>æ–‡ä»¶å®Œæ•´è·¯å¾„</td></tr><tr><td><code>size</code></td><td>integer</td><td>æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰</td></tr><tr><td><code>size_human</code></td><td>string</td><td>äººç±»å¯è¯»çš„æ–‡ä»¶å¤§å°</td></tr><tr><td><code>created_time</code></td><td>string</td><td>æ–‡ä»¶åˆ›å»ºæ—¶é—´</td></tr><tr><td><code>modified_time</code></td><td>string</td><td>æ–‡ä»¶ä¿®æ”¹æ—¶é—´</td></tr><tr><td><code>compressed</code></td><td>boolean</td><td>æ˜¯å¦å‹ç¼©</td></tr><tr><td><code>backup_type</code></td><td>string</td><td>å¤‡ä»½ç±»å‹</td></tr><tr><td><code>timestamp</code></td><td>string</td><td>æ—¶é—´æˆ³æ ‡è¯†</td></tr></tbody></table><h2 id="ä½¿ç”¨ç¤ºä¾‹" tabindex="-1">ä½¿ç”¨ç¤ºä¾‹ <a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹" aria-label="Permalink to â€œä½¿ç”¨ç¤ºä¾‹â€">â€‹</a></h2><h3 id="curl-ç¤ºä¾‹" tabindex="-1">cURL ç¤ºä¾‹ <a class="header-anchor" href="#curl-ç¤ºä¾‹" aria-label="Permalink to â€œcURL ç¤ºä¾‹â€">â€‹</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#FFCB6B;">curl</span><span style="color:#C3E88D;"> -X</span><span style="color:#C3E88D;"> GET</span><span style="color:#C3E88D;"> https://dbapi.muzilix.cn/database/my_database/backups</span><span style="color:#BABED8;"> \\</span></span>
<span class="line"><span style="color:#C3E88D;">  -H</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">Authorization: Bearer your_api_key</span><span style="color:#89DDFF;">&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="python-ç¤ºä¾‹" tabindex="-1">Python ç¤ºä¾‹ <a class="header-anchor" href="#python-ç¤ºä¾‹" aria-label="Permalink to â€œPython ç¤ºä¾‹â€">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#C792EA;">def</span><span style="color:#82AAFF;"> list_database_backups</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">api_key</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> db_name</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    &quot;&quot;&quot;</span><span style="color:#676E95;font-style:italic;">è·å–æ•°æ®åº“å¤‡ä»½åˆ—è¡¨</span><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    url </span><span style="color:#89DDFF;">=</span><span style="color:#C792EA;"> f</span><span style="color:#C3E88D;">&quot;https://dbapi.muzilix.cn/database/</span><span style="color:#F78C6C;">{</span><span style="color:#BABED8;">db_name</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">/backups&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    headers </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;"> {</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Authorization</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;"> f</span><span style="color:#C3E88D;">&quot;Bearer </span><span style="color:#F78C6C;">{</span><span style="color:#BABED8;">api_key</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#BABED8;">    response </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> requests</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">url</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> headers</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">headers</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    return</span><span style="color:#BABED8;"> response</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">json</span><span style="color:#89DDFF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#82AAFF;"> analyze_backup_storage</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">api_key</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> db_name</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    &quot;&quot;&quot;</span><span style="color:#676E95;font-style:italic;">åˆ†æå¤‡ä»½å­˜å‚¨ä½¿ç”¨æƒ…å†µ</span><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    backups_data </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> list_database_backups</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">api_key</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> db_name</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    if</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">error</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> in</span><span style="color:#BABED8;"> backups_data</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;é”™è¯¯: </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">backups_data</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">error</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        return</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#82AAFF;">    print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;æ•°æ®åº“: </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">backups_data</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">database</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">    print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;å¤‡ä»½æ•°é‡: </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">backups_data</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">backup_count</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#BABED8;">    total_size </span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;"> 0</span></span>
<span class="line"><span style="color:#BABED8;">    compressed_count </span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;"> 0</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#82AAFF;">    print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">\\n</span><span style="color:#C3E88D;">ğŸ“Š å¤‡ä»½æ–‡ä»¶åˆ—è¡¨:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    for</span><span style="color:#BABED8;"> backup </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#BABED8;"> backups_data</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">backups</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]:</span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;</span><span style="color:#BABED8;">\\n</span><span style="color:#C3E88D;">ğŸ“ </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">backup</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">filename</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;   å¤§å°: </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">backup</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">size_human</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;   ç±»å‹: </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">backup</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">backup_type</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;   å‹ç¼©: </span><span style="color:#F78C6C;">{</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">æ˜¯</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;font-style:italic;"> if</span><span style="color:#82AAFF;"> backup</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">compressed</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#89DDFF;font-style:italic;"> else</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#C3E88D;">å¦</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;   åˆ›å»ºæ—¶é—´: </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">backup</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">created_time</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#BABED8;">        total_size </span><span style="color:#89DDFF;">+=</span><span style="color:#BABED8;"> backup</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">size</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        if</span><span style="color:#BABED8;"> backup</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">compressed</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]:</span></span>
<span class="line"><span style="color:#BABED8;">            compressed_count </span><span style="color:#89DDFF;">+=</span><span style="color:#F78C6C;"> 1</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#82AAFF;">    print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;</span><span style="color:#BABED8;">\\n</span><span style="color:#C3E88D;">ğŸ“ˆ ç»Ÿè®¡ä¿¡æ¯:&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">    print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;   æ€»å­˜å‚¨ç©ºé—´: </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">format_size</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">total_size</span><span style="color:#89DDFF;">)</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">    print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;   å‹ç¼©å¤‡ä»½: </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">compressed_count</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">/</span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">backups_data</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">backup_count</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># ä½¿ç”¨ç¤ºä¾‹</span></span>
<span class="line"><span style="color:#BABED8;">backups </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> list_database_backups</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">your_api_key</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">production_db</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">analyze_backup_storage</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">your_api_key</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">production_db</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h2 id="å¤‡ä»½ç±»å‹è¯´æ˜" tabindex="-1">å¤‡ä»½ç±»å‹è¯´æ˜ <a class="header-anchor" href="#å¤‡ä»½ç±»å‹è¯´æ˜" aria-label="Permalink to â€œå¤‡ä»½ç±»å‹è¯´æ˜â€">â€‹</a></h2><h3 id="å¤‡ä»½ç±»å‹è¯†åˆ«" tabindex="-1">å¤‡ä»½ç±»å‹è¯†åˆ« <a class="header-anchor" href="#å¤‡ä»½ç±»å‹è¯†åˆ«" aria-label="Permalink to â€œå¤‡ä»½ç±»å‹è¯†åˆ«â€">â€‹</a></h3><p>ä»æ–‡ä»¶åè§£æå¤‡ä»½ç±»å‹ï¼š</p><ul><li><code>manual</code> - æ‰‹åŠ¨åˆ›å»ºçš„å¤‡ä»½</li><li><code>auto</code> - è‡ªåŠ¨å¤‡ä»½ä»»åŠ¡åˆ›å»º</li><li><code>pre_deployment</code> - éƒ¨ç½²å‰å¤‡ä»½</li><li>å…¶ä»–è‡ªå®šä¹‰ç±»å‹</li></ul><h3 id="æ–‡ä»¶å‘½åæ¨¡å¼" tabindex="-1">æ–‡ä»¶å‘½åæ¨¡å¼ <a class="header-anchor" href="#æ–‡ä»¶å‘½åæ¨¡å¼" aria-label="Permalink to â€œæ–‡ä»¶å‘½åæ¨¡å¼â€">â€‹</a></h3><p>å¤‡ä»½æ–‡ä»¶éµå¾ªç‰¹å®šå‘½åæ¨¡å¼ï¼Œä¾¿äºè¯†åˆ«ï¼š</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8;" tabindex="0" dir="ltr"><code><span class="line"><span>{ç”¨æˆ·å}_{æ•°æ®åº“å}_{ç±»å‹}_{æ—¶é—´æˆ³}.{æ‰©å±•å}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="å¤‡ä»½ç®¡ç†" tabindex="-1">å¤‡ä»½ç®¡ç† <a class="header-anchor" href="#å¤‡ä»½ç®¡ç†" aria-label="Permalink to â€œå¤‡ä»½ç®¡ç†â€">â€‹</a></h2><h3 id="å­˜å‚¨åˆ†æ" tabindex="-1">å­˜å‚¨åˆ†æ <a class="header-anchor" href="#å­˜å‚¨åˆ†æ" aria-label="Permalink to â€œå­˜å‚¨åˆ†æâ€">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#C792EA;">def</span><span style="color:#82AAFF;"> find_largest_backups</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">api_key</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> db_name</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> limit</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">5</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    &quot;&quot;&quot;</span><span style="color:#676E95;font-style:italic;">æŸ¥æ‰¾æœ€å¤§çš„å¤‡ä»½æ–‡ä»¶</span><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    backups_data </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> list_database_backups</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">api_key</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> db_name</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    if</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">error</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> in</span><span style="color:#BABED8;"> backups_data</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        return</span><span style="color:#89DDFF;"> []</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    # æŒ‰æ–‡ä»¶å¤§å°æ’åº</span></span>
<span class="line"><span style="color:#BABED8;">    sorted_backups </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> sorted</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">backups_data</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">backups</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span><span style="color:#BABED8;font-style:italic;"> key</span><span style="color:#89DDFF;">=</span><span style="color:#C792EA;">lambda</span><span style="color:#BABED8;font-style:italic;"> x</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> x</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">size</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span><span style="color:#BABED8;font-style:italic;"> reverse</span><span style="color:#89DDFF;">=True)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    return</span><span style="color:#BABED8;"> sorted_backups</span><span style="color:#89DDFF;">[:</span><span style="color:#BABED8;">limit</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#82AAFF;"> find_old_backups</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">api_key</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> db_name</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> days_threshold</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">30</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    &quot;&quot;&quot;</span><span style="color:#676E95;font-style:italic;">æŸ¥æ‰¾æ—§çš„å¤‡ä»½æ–‡ä»¶</span><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    backups_data </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> list_database_backups</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">api_key</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> db_name</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    if</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">error</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> in</span><span style="color:#BABED8;"> backups_data</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        return</span><span style="color:#89DDFF;"> []</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    from</span><span style="color:#BABED8;"> datetime </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> datetime</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> timedelta</span></span>
<span class="line"><span style="color:#BABED8;">    cutoff_date </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> datetime</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">now</span><span style="color:#89DDFF;">()</span><span style="color:#89DDFF;"> -</span><span style="color:#82AAFF;"> timedelta</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">days</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">days_threshold</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#BABED8;">    old_backups </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;"> []</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    for</span><span style="color:#BABED8;"> backup </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#BABED8;"> backups_data</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">backups</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]:</span></span>
<span class="line"><span style="color:#BABED8;">        created_time </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> datetime</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">fromisoformat</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">backup</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">created_time</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">].</span><span style="color:#82AAFF;">replace</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Z</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#C3E88D;">+00:00</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">))</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        if</span><span style="color:#BABED8;"> created_time </span><span style="color:#89DDFF;">&lt;</span><span style="color:#BABED8;"> cutoff_date</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">            old_backups</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">backup</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    return</span><span style="color:#BABED8;"> old_backups</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># ä½¿ç”¨ç¤ºä¾‹</span></span>
<span class="line"><span style="color:#BABED8;">largest_backups </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> find_largest_backups</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">your_api_key</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">analytics_db</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F78C6C;"> 3</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">æœ€å¤§çš„å¤‡ä»½æ–‡ä»¶:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#BABED8;"> backup </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#BABED8;"> largest_backups</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#82AAFF;">    print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;  </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">backup</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">filename</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;"> - </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">backup</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">size_human</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">old_backups </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> find_old_backups</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">your_api_key</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">analytics_db</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F78C6C;"> 60</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;</span><span style="color:#BABED8;">\\n</span><span style="color:#C3E88D;">è¶…è¿‡60å¤©çš„æ—§å¤‡ä»½: </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">len</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">old_backups</span><span style="color:#89DDFF;">)</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;"> ä¸ª&quot;</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h3 id="å¤‡ä»½æ¸…ç†å»ºè®®" tabindex="-1">å¤‡ä»½æ¸…ç†å»ºè®® <a class="header-anchor" href="#å¤‡ä»½æ¸…ç†å»ºè®®" aria-label="Permalink to â€œå¤‡ä»½æ¸…ç†å»ºè®®â€">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8;" tabindex="0" dir="ltr"><code><span class="line"><span style="color:#C792EA;">def</span><span style="color:#82AAFF;"> suggest_backup_cleanup</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">api_key</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> db_name</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    &quot;&quot;&quot;</span><span style="color:#676E95;font-style:italic;">æä¾›å¤‡ä»½æ¸…ç†å»ºè®®</span><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    backups_data </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> list_database_backups</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">api_key</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> db_name</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    if</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">error</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> in</span><span style="color:#BABED8;"> backups_data</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        return</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#BABED8;">    total_count </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> backups_data</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">backup_count</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#BABED8;">    max_backups </span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;"> 10</span><span style="color:#676E95;font-style:italic;">  # å»ºè®®ä¿ç•™çš„æœ€å¤§å¤‡ä»½æ•°</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    if</span><span style="color:#BABED8;"> total_count </span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;"> max_backups</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;âš ï¸  å¤‡ä»½æ•°é‡ (</span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">total_count</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">) è¶…è¿‡å»ºè®®å€¼ (</span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">max_backups</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">)&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">        # æŒ‰æ—¶é—´æ’åºï¼Œå»ºè®®åˆ é™¤æœ€æ—§çš„</span></span>
<span class="line"><span style="color:#BABED8;">        sorted_backups </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> sorted</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">backups_data</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">backups</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span><span style="color:#BABED8;font-style:italic;"> key</span><span style="color:#89DDFF;">=</span><span style="color:#C792EA;">lambda</span><span style="color:#BABED8;font-style:italic;"> x</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> x</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">created_time</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">])</span></span>
<span class="line"><span style="color:#BABED8;">        old_backups </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> sorted_backups</span><span style="color:#89DDFF;">[:</span><span style="color:#BABED8;">total_count </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> max_backups</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#82AAFF;">        print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">å»ºè®®åˆ é™¤çš„æ—§å¤‡ä»½:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        for</span><span style="color:#BABED8;"> backup </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#BABED8;"> old_backups</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#82AAFF;">            print</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&quot;  - </span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">backup</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">filename</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;"> (</span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">backup</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">created_time</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">)&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># ä½¿ç”¨ç¤ºä¾‹</span></span>
<span class="line"><span style="color:#82AAFF;">suggest_backup_cleanup</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">your_api_key</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">production_db</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="æ–‡ä»¶ä¿¡æ¯" tabindex="-1">æ–‡ä»¶ä¿¡æ¯ <a class="header-anchor" href="#æ–‡ä»¶ä¿¡æ¯" aria-label="Permalink to â€œæ–‡ä»¶ä¿¡æ¯â€">â€‹</a></h2><h3 id="æ—¶é—´ä¿¡æ¯" tabindex="-1">æ—¶é—´ä¿¡æ¯ <a class="header-anchor" href="#æ—¶é—´ä¿¡æ¯" aria-label="Permalink to â€œæ—¶é—´ä¿¡æ¯â€">â€‹</a></h3><ul><li><code>created_time</code>: æ–‡ä»¶åˆ›å»ºæ—¶é—´ï¼ˆISO 8601 æ ¼å¼ï¼‰</li><li><code>modified_time</code>: æœ€åä¿®æ”¹æ—¶é—´</li><li><code>timestamp</code>: ä»æ–‡ä»¶åæå–çš„æ—¶é—´æˆ³æ ‡è¯†</li></ul><h3 id="å¤§å°ä¿¡æ¯" tabindex="-1">å¤§å°ä¿¡æ¯ <a class="header-anchor" href="#å¤§å°ä¿¡æ¯" aria-label="Permalink to â€œå¤§å°ä¿¡æ¯â€">â€‹</a></h3><ul><li><code>size</code>: åŸå§‹å­—èŠ‚æ•°</li><li><code>size_human</code>: æ ¼å¼åŒ–çš„å¤§å°ï¼ˆKB, MB, GBï¼‰</li></ul><h2 id="ç›¸å…³é“¾æ¥" tabindex="-1">ç›¸å…³é“¾æ¥ <a class="header-anchor" href="#ç›¸å…³é“¾æ¥" aria-label="Permalink to â€œç›¸å…³é“¾æ¥â€">â€‹</a></h2><ul><li><a href="./../backup-recovery/">å¤‡ä»½æ¢å¤æ€»è§ˆ</a></li><li><a href="./backup-database">åˆ›å»ºå¤‡ä»½</a></li><li><a href="./download-backup">ä¸‹è½½å¤‡ä»½</a></li><li><a href="./delete-backup">åˆ é™¤å¤‡ä»½</a></li><li><a href="./backup-status">å¤‡ä»½çŠ¶æ€</a></li></ul>`,43)])])}const u=a(o,[["render",e]]);export{i as __pageData,u as default};
